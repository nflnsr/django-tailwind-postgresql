{% extends "layout.html" %}





{% block body %}

{% if request.user.is_authenticated %}
<div class="">
    <div>
        <h2 class="bg-red-200 w-fit h-fit mx-auto"> {{ request.user }} </h2>
    </div>
    <div class="w-16 h-8 mx-auto">
        <a href="{% url 'logout' %}" class="w-16">
            <div class="bg-blue-400 border-2 mx-auto w-16 h-8 text-center">Logout</div>
        </a>
    </div>
</div>

<header class="">
    <div class="bg-blue-300 py-6">
        <div class="bg-green-300 text-center w-2/3 mx-auto lg:w-1/6 md:ml-28 md:w-1/5 sm:w-2/5">
            <h1 class="text-3x1 font-bold text-2xl">Naufal Nasrullah ãƒ„</h1>
        </div>
    </div>
</header>


<main class="bg-violet-300 mx-auto border-8 border-red-300 md:w-4/5 xl:w-3/5 mt-8">
    <div class="">
        <h1 class="text-2xl text-center">to do list Apps</h1>
    </div>
    <div class="">
        <table class="border-collapse text-center p-2 bg-gray-100 border border-slate-500 mx-auto">
            <thead class="">
                <tr class="">
                    <th class="sm:px-3 px-2 bg-gray-300 border border-slate-600">No</th>
                    <th class="sm:px-6 px-4 bg-gray-300 border border-slate-600">Task</th>
                    <th class="sm:px-5 px-3 bg-gray-300 border border-slate-600">Priority</th>
                    <th class="sm:px-6 px-3 bg-gray-300 border border-slate-600">Date Created</th>
                    <th class="sm:px-6 px-2 bg-gray-300 border col-span-1 border-slate-600">Action</th>
                </tr>
            </thead>
            <tbody>
                {% for list in lists %}
                {% if list.priority > 7 %}
                <tr class=''>
                    <td class='border bg-green-300 border-slate-600'>{{ forloop.counter }}</td>
                    <td class='border bg-green-300 sm:px-2 px-1 border-slate-600'> {{ list.task }} </td>
                    <td class='border bg-green-300 border-slate-600'> {{ list.priority }} </td>
                    <td class='border bg-green-300 border-slate-600'> {{ list.date_created }} </td>
                    <td class='border  border-slate-600 py-1 sm:px-1 sm:flex'>
                        <button class='w-2/3 mb-1 sm:mb-0 sm:px-4 sm:mx-1 bg-green-300'><a href="{% url 'edit' list.id %}">edit</a></button>
                        <button class='w-2/3 sm:px-2 bg-red-300 px-3'><a class='flex justify-center'
                                href="{% url 'delete' list.id %}">remove</a></button>
                    </td>
                </tr>

                {% elif list.priority < 4 %}
                <tr>
                    <td class='border bg-red-300 border-slate-600'>{{ forloop.counter }}</td>
                    <td class='border bg-red-300 sm:px-2 px-1 border-slate-600'> {{ list.task }} </td>
                    <td class='border bg-red-300 border-slate-600'> {{ list.priority }} </td>
                    <td class='border bg-red-300 border-slate-600'> {{ list.date_created }} </td>
                    <td class='border  border-slate-600 py-1 sm:px-1 sm:flex'>
                        <button class='w-2/3 mb-1 sm:mb-0 sm:px-4 sm:mx-1 bg-green-300'><a href="{% url 'edit' list.id %}">edit</a></button>
                        <button class='w-2/3 sm:px-2 bg-red-300 px-3'><a class='flex justify-center'
                                href="{% url 'delete' list.id %}">remove</a></button>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td class='border bg-yellow-200 border-slate-600'>{{ forloop.counter }}</td>
                    <td class='border bg-yellow-200 sm:px-2 px-1 border-slate-600'> {{ list.task }} </td>
                    <td class='border bg-yellow-200 border-slate-600'> {{ list.priority }} </td>
                    <td class='border bg-yellow-200 border-slate-600'> {{ list.date_created }} </td>
                    <td class='border border-slate-600 py-1 sm:px-1 sm:flex'>
                        <button class='w-2/3 mb-1 sm:mb-0 sm:px-4 sm:mx-1 bg-green-300'><a href="{% url 'edit' list.id %}">edit</a></button>
                        <button class='w-2/3 sm:px-2 bg-red-300 px-3'><a class='flex justify-center'
                                href="{% url 'delete' list.id %}">remove</a></button>
                    </td>
                </tr>
                {% endif %}
                {% empty %}
                <tr>
                    <td colspan="5" class="text-center py-2 px-4">You don't have any task</td>
                </tr>
                <tr>
                    <td colspan="5" class="text-center py-2">Create your task by clicking the button bellow!</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</main>

<div class="mx-auto bg-transparent xl:w-3/5 md:w-4/5 md:px-2 mt-6 text-sm">
    <div class="flex lg:justify-center lg:gap-x-24">
        <div class="flex items-center justify-center w-5/12 lg:w-fit gap-1 cursor-default">
            <div class="w-4 h-4 bg-green-300 flex items-center group">
                <div class="flex items-center w-20">
                    <div class="text-white bg-gradient-to-bl z-10 ml-5 group-hover:block hidden">
                        <div class="w-16 text-center">8 - 10</div>
                    </div>
                </div>
            </div>
            <div class="z-0">important</div>
        </div>

        <div class="flex items-center justify-center w-2/12 lg:w-fit gap-1 cursor-default">
            <div class="w-4 h-4 bg-yellow-200 flex items-center group">
                <div class="flex items-center w-20">
                    <div class="text-white bg-gradient-to-tr z-10 ml-5 group-hover:block hidden">
                        <div class="w-16 text-center">4 - 7</div>
                    </div>
                </div>
            </div>
            <div class="z-0">not too</div>
        </div>

        <div class="flex items-center justify-center w-5/12 lg:w-fit gap-1 cursor-default">
            <div class="w-4 h-4 bg-red-300 flex items-center group">
                <div class="flex items-center w-20">
                    <div class="text-white bg-gradient-to-tl z-10 ml-5 group-hover:block hidden">
                        <div class="w-16 text-center">1 - 3</div>
                    </div>
                </div>
            </div>
            <div class="z-0">so-so</div>
        </div>
    </div>
</div>

<div class="bg-gray-200 mx-auto border-8 border-green-300 xl:w-3/5 md:w-4/5 md:px-2 mt-8">
    <form id="form" class="hidden" action="" method="POST">
        {% csrf_token %}
        <div class="sm:flex sm:justify-center mb-4 sm:gap-1 sm:px-2 mt-4 lg:mt-8">
            <div class="md:text-center lg:flex lg:items-center sm:w-1/3 sm:block gap-1 lg:gap-0 mb-2">
                <div class="my-auto flex justify-center lg:justify-start lg:min-w-fit">
                    <label class="block sm:hidden" for="task">New Task</label>
                    <label class="hidden sm:block" for="task">New Task :</label>
                </div>
                <div class="sm:block h-8 flex lg:flex-grow lg:pl-1 justify-center">
                    <input
                        class="w-2/3 focus:border-white focus:border-0 sm:w-full lg:px-1 lg:text-left text-center border-gray-400 rounded-lg border-1 sm:h-8"
                        type="text" name="task" id="task-form" placeholder="Your task">
                </div>
            </div>
            <div class="md:text-center lg:flex lg:items-center sm:w-1/3 sm:block gap-1 lg:gap-0 mb-2">
                <div class="my-auto flex justify-center lg:justify-start lg:min-w-fit">
                    <label class="block sm:hidden" for="task">Priority</label>
                    <label class="hidden sm:block" for="task">Priority :</label>
                </div>
                <div class="sm:block h-8 flex lg:flex-grow lg:pl-1 justify-center">
                    <input
                        class="w-1/3 focus:border-white focus:border-0 sm:w-full lg:px-1 lg:text-left text-center border-gray-400 rounded-lg border-1 sm:h-8"
                        type="text" name="priority" id="priority-form" placeholder="1 - 10">
                </div>
            </div>
            <div class="md:text-center lg:flex lg:items-center sm:w-1/3 sm:block gap-1 lg:gap-0 mb-2">
                <div class="my-auto flex justify-center lg:justify-start lg:min-w-fit">
                    <label class="block min- sm:hidden" for="task">Date Created</label>
                    <label class="hidden sm:block" for="task">Date Created :</label>
                </div>
                <div class="sm:block h-8 flex lg:flex-grow lg:pl-1 justify-center">
                    <input
                        class="w-2/4 focus:border-white focus:border-0 sm:w-full lg:px-1 lg:text-left text-center border-gray-400 rounded-lg border-1 bg-gray-100 sm:h-8"
                        type="text" name="date_created" id="date-form " value="{{ today }}" disabled>
                </div>
            </div>
            <div class="">
                <input type="text" name="user" id="user" value="{{ user.id }}">
            </div>
        </div>
        <div class="text-center mb-6 lg:mb-8">
            <input type="submit" name="submit" value="Submit"
                class="bg-blue-400 hover:bg-blue-300 cursor-pointer px-5 py-2 rounded-lg">
        </div>
    </form>
</div>

<div id="show-form" class="bg-blue-500 mx-auto border-8 border-blue-300 md:w-4/5 xl:w-3/5 mt-8 rounded-2xl">
    <div onclick="showForm()" class="mx-auto w-full">
        <button class="w-full hover:bg-blue-400 text-white font-bold py-2 px-4 rounded-lg">Add Task</button>
    </div>
</div>

<script type="text/javascript">
    function showForm() {
        // let task_form = document.getElementById("task-form");
        let x = document.getElementById("form");
        if (x.className === "hidden") {
            x.className = "block";
        }else {
            x.className = "hidden";
        }
    }
</script>

{% else %}
<script>
    // cara alternatif kalo abis logout/blom login, redirect ke login
    window.location.replace("{% url 'login' %}");
</script>

<a href="{% url 'login' %}">Login</a>
{% endif %}
{% endblock %}